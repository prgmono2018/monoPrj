"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = ToggleListItemPlugin;

// This plugin toggles a list item on and off
function ToggleListItemPlugin() {
  return {
    onCommand(command, editor, next) {
      if (command.type !== 'toggleListItem') {
        return next();
      }

      const listItemName = command.args[0];
      const blocks = editor.value.blocks;

      if (blocks.length === 0) {
        return next();
      }

      const active = blocks.some(block => block.data.get('listItem') === listItemName);
      blocks.forEach(block => {
        const data = block.data ? block.data.toObject() : {};

        if (active) {
          delete data.listItem;
        } else {
          data.listItem = listItemName;
          data.level = data.level || 1;
        }

        editor.setNodeByKey(block.key, {
          data: data
        });
      });
      editor.focus();
      return editor;
    }

  };
}